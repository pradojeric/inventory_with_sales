import{r as a,j as t,a as F}from"./app-WAcuAQYG.js";import{A as G}from"./AuthenticatedLayout-Lew2t8BI.js";import{c as u,B as J}from"./Toast-xa_T1Asx.js";import K from"./AddItem-zBV4LLkM.js";import{b as M,H as U}from"./index-izUsY6vX.js";import V from"./OrderList-AQ11dU1O.js";import W from"./Checkout-Cf-ad1m0.js";import{formatNumber as X}from"./Util-py14zHy8.js";import"./ApplicationLogo-UB9_MBiy.js";import"./Modal-KXOwnuWY.js";import"./transition-mcgITBB2.js";function ne({auth:N,flash:Y,categories:n,products:x,order_no:C}){const[l,h]=a.useState(x),[w,m]=a.useState(n[0].products),[k,S]=a.useState(0),[P,f]=a.useState(!1),[A,L]=a.useState(),[d,p]=a.useState([]),[j,O]=a.useState(n[0].id),[I,Q]=a.useState(!1),[y,q]=a.useState(0),[g,_]=a.useState(0);a.useEffect(()=>{E(),R()},[d]);const H=e=>{const s=l.filter(o=>o.category_id==e);m(s)},v=()=>{f(e=>e=!e)},b=()=>{Q(e=>e=!e)},T=e=>{p([...d,e]);const s=[...l],o=s.map(i=>i.id).indexOf(e.id);s[o]={...s[o],quantity:Number(s[o].quantity-e.totalQuantity)},h(s);const r=s.filter(i=>i.category_id==j);m(r),f(i=>i=!i)},B=(e,s)=>()=>{p(d.filter((c,z)=>z!=s));const o=[...l],r=o.map(c=>c.id).indexOf(e.id),i=x.find(c=>c.id==e.id);o[r]=i,h(o);const D=o.filter(c=>c.category_id==j);m(D)},E=()=>{const e=d.reduce((r,i)=>r+i.newPrice*i.totalQuantity,0),s=d.reduce((r,i)=>r+i.quantityDiscounted*(i.newPrice-i.discountPerItem),0),o=s?e-s:e;q(o)},R=()=>{const e=d.reduce((s,o)=>s+o.totalQuantity,0);_(e)};return t.jsxs(G,{user:N.user,header:t.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Create Sales"}),children:[t.jsx(F,{title:"Sales"}),t.jsxs("div",{className:"py-12",children:[t.jsx(K,{item:A,show:P,onClose:v,onSave:T}),t.jsx(W,{totalAmount:y,totalQuantity:g,order_no:C,orders:d,show:I,onClose:b}),t.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:t.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:t.jsxs("div",{className:"p-6 text-gray-900 md:w-auto w-screen",children:[t.jsxs(u,{"aria-label":"Default breadcrumb example",children:[t.jsx(u.Item,{href:route("sales.index"),icon:M,children:"Orders"}),t.jsx(u.Item,{children:"Create"})]}),t.jsx("div",{className:"mb-3 flex justify-end",children:t.jsx(J,{type:"button",onClick:b,children:"Check out"})}),t.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[t.jsx("div",{className:"border rounded shadow-sm md:col-span-2",children:t.jsxs("div",{className:"flex bg-gray-200 max-h-96 h-screen",children:[t.jsx("div",{className:"flex flex-col divide-y",children:n.map((e,s)=>t.jsx("div",{children:t.jsx("button",{className:"p-4 uppercase tracking-tighter text-lg w-full "+(k==s?" font-semibold underline bg-white":"bg-gray-200 border-r"),onClick:()=>{H(e.id),S(s),O(e.id)},children:e.name})},e.name))}),t.jsx("div",{className:"flex flex-col grow divide-y overflow-y-auto p-2 bg-white",children:w.map(e=>t.jsxs("div",{className:"p-2 flex justify-between w-full items-center",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold",children:e.product_name}),t.jsx("div",{className:"text-sm",children:e.description}),t.jsx("div",{className:"text-sm",children:e.quantity+" remaining"}),t.jsx("div",{className:"text-sm",children:X(e.price)})]}),t.jsx("div",{children:t.jsx("button",{type:"button",onClick:()=>{v(),L(e)},children:t.jsx(U,{color:"green"})})})]},e.product_name))})]})}),t.jsx(V,{totalPrice:y,totalQuantity:g,products:d,handleRemoveOrder:B,canRemove:!0})]})]})})})]})]})}export{ne as default};
